<!DOCTYPE html>
<html lang="es">
<head>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f0f2f5;
    }
    header {
      background-color: #4267b2;
      color: white;
      text-align: center;
      padding: 1rem;
      border-radius: 8px 8px 0 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .logo {
      width: 100px;
      height: auto;
      margin-right: 20px;
    }
    .header-text {
      text-align: left;
    }
    nav {
      background-color: #365899;
      padding: 10px;
    }
    nav ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
      display: flex;
      justify-content: center;
    }
    nav ul li {
      margin: 0 10px;
    }
    nav ul li a {
      color: white;
      text-decoration: none;
      padding: 5px 10px;
      border-radius: 5px;
      transition: background-color 0.3s;
    }
    nav ul li a:hover {
      background-color: #4267b2;
    }
    main {
      background-color: white;
      padding: 20px;
      border-radius: 0 0 8px 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    h1 {
      margin-top: 0;
    }
    h2 {
      color: #4267b2;
    }
    .instructions {
      background-color: #e9ebee;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .instructions ol {
      margin-bottom: 0;
    }
    .code-block {
      background-color: #f1f3f4;
      border-left: 4px solid #4267b2;
      padding: 15px;
      margin-bottom: 20px;
      overflow-x: auto;
    }
    .button {
      display: inline-block;
      background-color: #4267b2;
      color: white;
      padding: 10px 20px;
      text-decoration: none;
      border-radius: 5px;
      transition: background-color 0.3s;
    }
    .button:hover {
      background-color: #365899;
    }
    @media (max-width: 600px) {
      header {
        flex-direction: column;
      }
      .logo {
        margin-right: 0;
        margin-bottom: 10px;
      }
      .header-text {
        text-align: center;
      }
    }
    .video-container {
      position: relative;
      width: 100%;
      padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
    }
    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .code-container {
      position: relative;
      margin-bottom: 20px;
    }
    .copy-button {
      position: absolute;
      top: 5px;
      right: 5px;
      background-color: #4267b2;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    .copy-confirmation {
      display: none;
      position: absolute;
      top: 5px;
      right: 80px;
      background-color: #4caf50;
      color: white;
      padding: 5px 10px;
      border-radius: 5px;
    }
    .copy-confirmation.show {
      display: block;
    }
    /* Estilo global para la barra de desplazamiento */
    * {
      scrollbar-width: thin;
      scrollbar-color: #6e8efb #e0e0e0;
    }
    /* Webkit browsers like Chrome and Safari */
    *::-webkit-scrollbar {
      width: 22px;
    }
    *::-webkit-scrollbar-track {
      background: #e0e0e0;
    }
    *::-webkit-scrollbar-thumb {
      background-color: #6e8efb;
      border-radius: 20px;
      border: 3px solid #e0e0e0;
    }
    /* Contenedor de ejemplo */
    .scroll-container {
      height: 200px;
      overflow-y: scroll;
      padding: 20px;
      border: 1px solid #ccc;
    }
    .linkedin-logo {
      width: 25%;
    }
  </style>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />
  <meta name="robots" content="index, follow" />
  <meta property="og:title" content="Automatizaci√≥n con PowerShell" />
  <meta
    name="keywords"
    content="PowerShell, scripts, formularios, automatizaci√≥n, administraci√≥n"
  />
  <meta
    name="description"
    content="Descubre scripts avanzados de PowerShell con formularios para automatizar tareas administrativas. Optimiza la gesti√≥n de sistemas, mejora la productividad, aplica la automatizacion y simplifica procesos con nuestras soluciones pr√°cticas y eficientes."
  />
  <title>Scripts de Vladi</title>
  <link rel="shortcut icon" href="./favicon.ico" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
  />
  <link
    rel="stylesheet"
    href="./assets/vendor/bootstrap-icons/font/bootstrap-icons.css"
  />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
</head>
<body>
  <header>
    <section id="overview">
      <h1>HealthCheck para servidores Windows</h1>
    </section>
  </header>
  <nav>
    <ul>
      <li><a href="#overview">Descripci√≥n General</a></li>
      <li><a href="#funciones">Funciones</a></li>
      <li><a href="#Uso">Uso</a></li>
      <li><a href="#script-completo">Script Completo</a></li>
    </ul>
  </nav>
  <main>
    <section id="overview">
      <h2>üìå Descripci√≥n General</h2>
      <p>
        Este script PowerShell (<b>HealthCheck.ps1</b>) es una herramienta avanzada de diagn√≥stico y monitoreo para sistemas Windows, dise√±ada para administradores de sistemas y equipos de soporte t√©cnico. Recopila informaci√≥n detallada sobre:
      </p>
      <ul>
        <li><b>Rendimiento del sistema</b> (CPU, memoria, disco, red).</li>
        <li><b>Eventos de seguridad y aplicaciones</b> (logs de Windows).</li>
        <li><b>Configuraciones cr√≠ticas</b> (pol√≠ticas de grupo, servicios, parches).</li>
        <li><b>Seguridad y cumplimiento</b> (CIS Benchmarks, permisos de archivos, an√°lisis de software instalado).</li>
      </ul>
      <p>
        Genera informes en <b>HTML, JSON, CSV o Excel</b> para facilitar el an√°lisis y la documentaci√≥n.
      </p>
    </section>
    <section>
      <h2>¬øQu√© es un HealthCheck?</h2>
      <p>Un <b>HealthCheck</b> es un script o herramienta que permite verificar el estado de salud de un sistema, servidor o servicio. Es √∫til para administradores y operadores que desean asegurarse de que todo funciona correctamente y detectar problemas antes de que afecten a los usuarios.</p>
    </section>
    <section id="funciones">
      <h2>Funciones principales</h2>
      <ol>
        <li>
          <b>Get-InformacionSistema</b><br>
          <span>üìå <b>Prop√≥sito:</b> Obtiene informaci√≥n b√°sica del hardware y sistema operativo.</span>
          <ul>
            <li>Nombre del servidor, direcci√≥n IP, dominio.</li>
            <li>Modelo de CPU, memoria RAM, fabricante del equipo.</li>
            <li>Versi√≥n de Windows, tiempo de actividad (uptime).</li>
          </ul>
          <span>üõ†Ô∏è <b>Uso para administradores:</b></span>
          <pre><code class="language-powershell">$systemInfo = Get-InformacionSistema
Write-Output "Servidor: $($systemInfo.NombreServidor), Uptime: $($systemInfo.TiempoActividad.Days) d√≠as"</code></pre>
        </li>
        <li>
          <b>Get-MetricasRendimiento</b><br>
          <span>üìå <b>Prop√≥sito:</b> Analiza los 4 subsistemas cr√≠ticos (CPU, Memoria, Disco, Red).</span>
          <ul>
            <li>Uso de CPU (% y cola de procesos).</li>
            <li>Consumo de memoria (RAM y virtual).</li>
            <li>Rendimiento de discos (latencia, espacio libre).</li>
            <li>Tr√°fico de red (bytes enviados/recibidos).</li>
          </ul>
          <span>üõ†Ô∏è <b>Uso para administradores:</b></span>
          <pre><code class="language-powershell">$metrics = Get-MetricasRendimiento
if ($metrics.CPU.UsoCPU -gt 90) { 
    Write-Warning "¬°CPU en estado cr√≠tico!" 
}</code></pre>
        </li>
        <li>
          <b>Get-LogsEventos</b><br>
          <span>üìå <b>Prop√≥sito:</b> Recupera eventos de los logs de Sistema, Aplicaci√≥n y Seguridad.</span>
          <ul>
            <li>Errores y advertencias de los √∫ltimos $DiasLogs d√≠as.</li>
            <li>Intentos de inicio de sesi√≥n fallidos (√∫til para detectar ataques).</li>
            <li>Eventos cr√≠ticos de servicios y aplicaciones.</li>
          </ul>
          <span>üõ†Ô∏è <b>Uso para administradores:</b></span>
          <pre><code class="language-powershell">$logs = Get-LogsEventos -Dias 7
$logs.LogsSeguridad | Where-Object { $_.EventType -eq "Login Fallido" } | Format-Table</code></pre>
        </li>
        <li>
          <b>Get-AnalisisConfiabilidad</b><br>
          <span>üìå <b>Prop√≥sito:</b> Eval√∫a la estabilidad del sistema (eventos de fallos, reinicios).</span>
          <ul>
            <li>Historial de fallos de aplicaciones.</li>
            <li>Eventos de apagado inesperado.</li>
            <li>Tendencias de estabilidad (semanal).</li>
          </ul>
          <span>üõ†Ô∏è <b>Uso para administradores:</b></span>
          <pre><code class="language-powershell">$confiabilidad = Get-AnalisisConfiabilidad
if ($confiabilidad.EstadisticasEstabilidad.IndiceEstabilidad -eq "Baja") {
    Send-Alert -Message "El servidor es inestable"
}</code></pre>
        </li>
        <li>
          <b>Get-VerificacionCumplimiento</b><br>
          <span>üìå <b>Prop√≥sito:</b> Verifica el cumplimiento con CIS Benchmarks (est√°ndar de seguridad).</span>
          <ul>
            <li>Pol√≠ticas de contrase√±a (longitud, complejidad).</li>
            <li>Configuraci√≥n de firewall y UAC.</li>
            <li>Estado de Windows Defender.</li>
          </ul>
          <span>üõ†Ô∏è <b>Uso para administradores:</b></span>
          <pre><code class="language-powershell">$cumplimiento = Get-VerificacionCumplimiento
if ($cumplimiento.Verificaciones | Where-Object { $_.Cumple -eq "No" }) {
    Write-Output "¬°Ajustes de seguridad no cumplen CIS Benchmarks!"
}</code></pre>
        </li>
        <li>
          <b>Get-AnalisisPermisos</b><br>
          <span>üìå <b>Prop√≥sito:</b> Audita permisos en carpetas sensibles (C:\Windows, C:\Program Files).</span>
          <ul>
            <li>Permisos excesivos para grupos como Everyone.</li>
            <li>Archivos del sistema con permisos de escritura p√∫blicos.</li>
          </ul>
          <span>üõ†Ô∏è <b>Uso para administradores:</b></span>
          <pre><code class="language-powershell">$permisos = Get-AnalisisPermisos
$permisos.AnalisisPermisos | Where-Object { $_.Estado -eq "Cr√≠tico" } | Export-Csv -Path "permisos_peligrosos.csv"</code></pre>
        </li>
        <li>
          <b>Get-AuditoriaSoftware</b><br>
          <span>üìå <b>Prop√≥sito:</b> Detecta software vulnerable o desactualizado.</span>
          <ul>
            <li>Lista de programas instalados (versi√≥n, fecha de instalaci√≥n).</li>
            <li>Software sin soporte (Java antiguo, Adobe Flash).</li>
            <li>Navegadores con plugins inseguros.</li>
          </ul>
          <span>üõ†Ô∏è <b>Uso para administradores:</b></span>
          <pre><code class="language-powershell">$software = Get-AuditoriaSoftware
$software.SoftwareProblematico | Where-Object { $_.CriticidadMaxima -eq "Alta" } | Format-Table</code></pre>
        </li>
      </ol>
    </section>
    <section id="Uso">
      <h2>üìÇ Generaci√≥n de Informes</h2>
      <p>El script permite exportar datos en m√∫ltiples formatos:</p>
      <div class="code-block" style="overflow-x:auto;">
        <table style="width:100%; border-collapse:collapse;">
          <thead>
            <tr style="background:#e9ebee;">
              <th style="padding:8px; border:1px solid #ccc;">Formato</th>
              <th style="padding:8px; border:1px solid #ccc;">Comando de Ejemplo</th>
              <th style="padding:8px; border:1px solid #ccc;">Uso Recomendado</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="padding:8px; border:1px solid #ccc;">HTML</td>
              <td style="padding:8px; border:1px solid #ccc;">.\HealthCheck.ps1 -FormatoExportar HTML</td>
              <td style="padding:8px; border:1px solid #ccc;">Informes visuales para presentaciones.</td>
            </tr>
            <tr>
              <td style="padding:8px; border:1px solid #ccc;">JSON</td>
              <td style="padding:8px; border:1px solid #ccc;">.\HealthCheck.ps1 -FormatoExportar JSON</td>
              <td style="padding:8px; border:1px solid #ccc;">Integraci√≥n con SIEM (Splunk, Elastic).</td>
            </tr>
            <tr>
              <td style="padding:8px; border:1px solid #ccc;">CSV</td>
              <td style="padding:8px; border:1px solid #ccc;">.\HealthCheck.ps1 -FormatoExportar CSV</td>
              <td style="padding:8px; border:1px solid #ccc;">An√°lisis en Excel/Power BI.</td>
            </tr>
            <tr>
              <td style="padding:8px; border:1px solid #ccc;">EXCEL</td>
              <td style="padding:8px; border:1px solid #ccc;">.\HealthCheck.ps1 -FormatoExportar EXCEL</td>
              <td style="padding:8px; border:1px solid #ccc;">Reportes automatizados para auditor√≠as.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
    <section class="instructions">
      <h2>üîç Casos de Uso T√≠picos</h2>
      <ol>
        <li>
          <b>Monitoreo Proactivo de Servidores</b><br>
          <b>Problema:</b> Un servidor est√° lento.<br>
          <b>Soluci√≥n:</b> Ejecutar el script y revisar <code>Get-MetricasRendimiento</code> para identificar cuellos de botella (CPU, disco, memoria).
        </li>
        <li>
          <b>Investigaci√≥n de Incidentes de Seguridad</b><br>
          <b>Problema:</b> Sospecha de un ataque de fuerza bruta.<br>
          <b>Soluci√≥n:</b> Usar <code>Get-LogsEventos</code> para filtrar intentos de login fallidos y <code>Get-AnalisisPermisos</code> para detectar cambios en permisos.
        </li>
        <li>
          <b>Cumplimiento de Normativas (CIS, NIST)</b><br>
          <b>Problema:</b> Auditor√≠a requiere verificaci√≥n de hardening.<br>
          <b>Soluci√≥n:</b> Ejecutar <code>Get-VerificacionCumplimiento</code> y exportar a Excel para evidencias.
        </li>
        <li>
          <b>Detecci√≥n de Software Vulnerable</b><br>
          <b>Problema:</b> Necesidad de parchear sistemas cr√≠ticos.<br>
          <b>Soluci√≥n:</b> Usar <code>Get-AuditoriaSoftware</code> para listar programas desactualizados.
        </li>
      </ol>
    </section>

    <section>
      <h2>Script de HealthCheck en PowerShell</h2>
      <div class="code-block" id="codeBlock1">
<pre><code>function Invoke-HealthCheck {
    $result = @{}
    # Verifica espacio en disco
    $disks = Get-PSDrive -PSProvider FileSystem | Select-Object Name,Free,Used, @{N='Total';E={$_.Free+$_.Used}}
    $result['Disks'] = $disks
    # Verifica servicios cr√≠ticos
    $criticalServices = 'Spooler','wuauserv','WinRM'
    $services = Get-Service -Name $criticalServices | Select-Object Name,Status
    $result['Services'] = $services
    # Verifica uso de CPU
    $cpu = Get-WmiObject win32_processor | Measure-Object -Property LoadPercentage -Average | Select-Object Average
    $result['CPU'] = $cpu.Average
    # Verifica uso de memoria
    $mem = Get-WmiObject win32_operatingsystem
    $result['Memory'] = [math]::Round((1 - $mem.FreePhysicalMemory/$mem.TotalVisibleMemorySize)*100,2)
    return $result
}

# Ejecutar HealthCheck
Invoke-HealthCheck | Format-List</code></pre>
      <button class="copy-button" onclick="copyCode(this, 'codeBlock1')" aria-label="Copiar c√≥digo">Copiar</button>
      <div id="copyConfirmation1" class="copy-confirmation" aria-live="polite">¬°Copiado!</div>
      </div>
    </section>
    <section class="instructions">
      <h3>Instrucciones de uso</h3>
      <ol>
        <li>Abre PowerShell como administrador.</li>
        <li>Copia el script de arriba y p√©galo en la consola.</li>
        <li>Ejecuta <code>Invoke-HealthCheck</code> para ver el estado del sistema.</li>
        <li>Revisa los resultados y toma acciones si detectas alg√∫n problema.</li>
      </ol>
      <ul>
        <li><b>Discos:</b> Muestra el espacio libre y total de cada disco.</li>
        <li><b>Servicios:</b> Verifica que servicios cr√≠ticos est√©n en ejecuci√≥n.</li>
        <li><b>CPU:</b> Promedio de uso del procesador.</li>
        <li><b>Memoria:</b> Porcentaje de uso de memoria RAM.</li>
      </ul>
    </section>
  </main>
  <script>
    function copyCode(btn, blockId) {
      const codeBlock = document.getElementById(blockId).querySelector('code');
      const text = codeBlock.innerText;
      navigator.clipboard.writeText(text).then(function() {
        btn.nextElementSibling.style.display = 'inline';
        setTimeout(function() {
          btn.nextElementSibling.style.display = 'none';
        }, 1500);
      });
    }
  </script>
</body>
</html>
