<!DOCTYPE html>
<html lang="es">
<head>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f0f2f5;
    }
    header {
      background-color: #4267b2;
      color: white;
      text-align: center;
      padding: 1rem;
      border-radius: 8px 8px 0 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .logo {
      width: 100px;
      height: auto;
      margin-right: 20px;
    }
    .header-text {
      text-align: left;
    }
    nav {
      background-color: #365899;
      padding: 10px;
    }
    nav ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
      display: flex;
      justify-content: center;
    }
    nav ul li {
      margin: 0 10px;
    }
    nav ul li a {
      color: white;
      text-decoration: none;
      padding: 5px 10px;
      border-radius: 5px;
      transition: background-color 0.3s;
    }
    nav ul li a:hover {
      background-color: #4267b2;
    }
    main {
      background-color: white;
      padding: 20px;
      border-radius: 0 0 8px 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    h1 {
      margin-top: 0;
    }
    h2 {
      color: #4267b2;
    }
    .instructions {
      background-color: #e9ebee;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .instructions ol {
      margin-bottom: 0;
    }
    .code-block {
      background-color: #f1f3f4;
      border-left: 4px solid #4267b2;
      padding: 15px;
      margin-bottom: 20px;
      overflow-x: auto;
    }
    .button {
      display: inline-block;
      background-color: #4267b2;
      color: white;
      padding: 10px 20px;
      text-decoration: none;
      border-radius: 5px;
      transition: background-color 0.3s;
    }
    .button:hover {
      background-color: #365899;
    }
    @media (max-width: 600px) {
      header {
        flex-direction: column;
      }
      .logo {
        margin-right: 0;
        margin-bottom: 10px;
      }
      .header-text {
        text-align: center;
      }
    }
    .video-container {
      position: relative;
      width: 100%;
      padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
    }
    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .code-container {
      position: relative;
      margin-bottom: 20px;
    }
    .copy-button {
      position: absolute;
      top: 5px;
      right: 5px;
      background-color: #4267b2;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
    }
    .copy-confirmation {
      display: none;
      position: absolute;
      top: 5px;
      right: 80px;
      background-color: #4caf50;
      color: white;
      padding: 5px 10px;
      border-radius: 5px;
    }
    .copy-confirmation.show {
      display: block;
    }
    /* Estilo global para la barra de desplazamiento */
    * {
      scrollbar-width: thin;
      scrollbar-color: #6e8efb #e0e0e0;
    }

    /* Webkit browsers like Chrome and Safari */
    *::-webkit-scrollbar {
      width: 22px;
    }

    *::-webkit-scrollbar-track {
      background: #e0e0e0;
    }

    *::-webkit-scrollbar-thumb {
      background-color: #6e8efb;
      border-radius: 20px;
      border: 3px solid #e0e0e0;
    }

    /* Contenedor de ejemplo */
    .scroll-container {
      height: 200px;
      overflow-y: scroll;
      padding: 20px;
      border: 1px solid #ccc;
    }
  </style>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />
  <meta name="robots" content="index, follow" />
  <meta property="og:title" content="Documentación Técnica" />
  <meta
    name="keywords"
    content="documentación, técnica, scripts, herramientas, automatización"
  />
  <meta
    name="description"
    content="Documentación técnica detallada para herramientas y scripts especializados. Incluye descripciones, funciones, ejemplos de uso y código fuente completo."
  />
  <title>Documentación Técnica</title>
  <link rel="shortcut icon" href="./favicon.ico" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css"
  />
  <link
    rel="stylesheet"
    href="./assets/vendor/bootstrap-icons/font/bootstrap-icons.css"
  />
</head>
<body>
  <header>
    <div class="header-text">
      <h1>Analizador de Logs e Información Sensible</h1>
      <p>Documentación de la herramienta de análisis y clasificación de información</p>
    </div>
  </header>

  <nav>
    <ul>
      <li><a href="#overview">Descripción General</a></li>
      <li><a href="#functions">Funciones</a></li>
      <li><a href="#usage">Uso</a></li>
      <li><a href="#examples">Ejemplos</a></li>
      <li><a href="#script-completo">Script Completo</a></li>
    </ul>
  </nav>
  <a href="https://www.linkedin.com/in/vladimir-campos-830b83328/"
  target="_blank"
  ><center>
    <img
      src="/assets/Linkedin-Logo-e1660320077673.png"
      style="width: 25%;"/></center
></a>
  <main>
    <section id="overview">
      <h2>Descripción General</h2>
      <div class="instructions">
        <p>Este script es una herramienta avanzada para clasificar y analizar archivos de logs y otros documentos en busca de información sensible. Utiliza técnicas de procesamiento en paralelo, muestreo inteligente y caché SQLite para optimizar el rendimiento.</p>
        <ul>
          <li>Procesamiento en paralelo para análisis rápido</li>
          <li>Muestreo inteligente de archivos grandes</li>
          <li>Caché SQLite para resultados persistentes</li>
          <li>Detección de patrones de información sensible</li>
          <li>Generación de reportes detallados</li>
        </ul>
      </div>
    </section>

    <section id="functions">
      <h2>Funciones Principales</h2>
      
      <div class="section">
        <h3>1. Funciones de Configuración y Logging</h3>
        <div class="code-container">
          <h4>Inicializar-Logger</h4>
          <p>Configura el sistema de registro de eventos (logging) de la aplicación.</p>
          <pre><code class="language-powershell">function Inicializar-Logger {
    param(
        [string]$logLevel = "INFO",
        [bool]$consoleOutput = $true
    )</code></pre>
          <p><strong>Propósito:</strong></p>
          <ul>
            <li>Configura el sistema de registro de eventos (logging) de la aplicación.</li>
          </ul>
          <p><strong>Parámetros:</strong></p>
          <ul>
            <li><code>$logLevel</code>: Nivel de detalle ("DEBUG", "INFO", "WARN", "ERROR")</li>
            <li><code>$consoleOutput</code>: Si muestra logs en consola además de en archivo</li>
          </ul>
          <p><strong>Comportamiento:</strong></p>
          <ol>
            <li>Crea directorio de logs en %TEMP%\ClasificadorDeLogs\Logs\</li>
            <li>Genera nombre de archivo con timestamp y GUID único</li>
            <li>Inicializa objeto [Logger] con configuración especificada</li>
            <li>Registra evento de inicio de sesión</li>
          </ol>
          <p><strong>Relaciones:</strong></p>
          <ul>
            <li>Usada por el flujo principal al iniciar</li>
            <li>Llama a la clase Logger</li>
          </ul>
        </div>
        
        <div class="code-container">
          <h4>Cargar-Configuracion</h4>
          <p>Carga la configuración desde archivo JSON o usa valores por defecto.</p>
          <pre><code class="language-powershell">function Cargar-Configuracion {
    param([string]$rutaConfig = "")</code></pre>
          <p><strong>Propósito:</strong></p>
          <ul>
            <li>Carga la configuración desde archivo JSON o usa valores por defecto.</li>
          </ul>
          <p><strong>Flujo:</strong></p>
          <ol>
            <li>Busca config.json en %TEMP%\ClasificadorDeLogs\</li>
            <li>Si no existe, crea uno con valores por defecto</li>
            <li>Combina configuraciones con Merge-Configuracion</li>
            <li>Devuelve hashtable con configuración completa</li>
          </ol>
          <p><strong>Manejo de errores:</strong></p>
          <ul>
            <li>Captura errores de formato JSON</li>
            <li>Provee valores por defecto si falla</li>
          </ul>
        </div>
      </div>

      <div class="section">
        <h3>2. Funciones de Análisis Principal</h3>
        <div class="code-container">
          <h4>Clasificar-ArchivoRapido</h4>
          <p>Orquesta el proceso completo de clasificación de un archivo.</p>
          <pre><code class="language-powershell">function Clasificar-ArchivoRapido {
    param([string]$rutaArchivo)</code></pre>
          <p><strong>Propósito:</strong></p>
          <ul>
            <li>Orquesta el proceso completo de clasificación de un archivo.</li>
          </ul>
          <p><strong>Flujo de trabajo:</strong></p>
          <ol>
            <li>Verifica caché con Get-ResultadoCache</li>
            <li>Si no en caché:
              <ul>
                <li>Clasifica por extensión (Get-ClasificacionPorExtension)</li>
                <li>Si no es clasificación automática:
                  <ul>
                    <li>Detecta encoding (Detectar-Encoding)</li>
                    <li>Obtiene muestra representativa (Get-MuestraArchivo)</li>
                    <li>Analiza contenido (Analizar-ContenidoRapido)</li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>Determina clasificación final</li>
            <li>Guarda en caché (Set-ResultadoCache)</li>
          </ol>
          <p><strong>Salida:</strong></p>
          <p>Hashtable con:</p>
          <ul>
            <li>Clasificación</li>
            <li>Patrones detectados</li>
            <li>Tiempo de análisis</li>
            <li>Metadatos adicionales</li>
          </ul>
        </div>
        
        <div class="code-container">
          <h4>Analizar-ContenidoRapido</h4>
          <p>Busca patrones de información sensible en contenido textual.</p>
          <pre><code class="language-powershell">function Analizar-ContenidoRapido {
    param([string]$contenido)</code></pre>
          <p><strong>Propósito:</strong></p>
          <ul>
            <li>Busca patrones de información sensible en contenido textual.</li>
          </ul>
          <p><strong>Técnicas empleadas:</strong></p>
          <ul>
            <li>Usa regex precompilados para máximo rendimiento</li>
            <li>Aplica validaciones contextuales (ej. para teléfonos)</li>
            <li>Limita cantidad de coincidencias por categoría</li>
          </ul>
          
          <p><strong>Patrones detectados:</strong></p>
          <div style="width: 400px; height: 400px;">
            <canvas id="patronesChart"></canvas>
          </div>
          <script>
            document.addEventListener('DOMContentLoaded', function() {
              const ctx = document.getElementById('patronesChart');
              
              new Chart(ctx, {
                type: 'pie',
                data: {
                  labels: ['Teléfonos', 'Credenciales', 'Claves', 'SIDs', 'Hashes', 'Timestamps', 'Otros'],
                  datasets: [{
                    label: 'Distribución de Patrones',
                    data: [25, 20, 15, 10, 10, 10, 10],
                    backgroundColor: [
                      'rgba(255, 99, 132, 0.7)',
                      'rgba(54, 162, 235, 0.7)',
                      'rgba(255, 206, 86, 0.7)',
                      'rgba(75, 192, 192, 0.7)',
                      'rgba(153, 102, 255, 0.7)',
                      'rgba(255, 159, 64, 0.7)',
                      'rgba(199, 199, 199, 0.7)'
                    ],
                    borderWidth: 1
                  }]
                },
                options: {
                  responsive: true,
                  plugins: {
                    legend: {
                      position: 'right',
                    },
                    title: {
                      display: true,
                      text: 'Distribución de Patrones'
                    }
                  }
                }
              });
            });
          </script>
        </div>
      </div>

      <div class="section">
        <h3>3. Funciones de Soporte</h3>
        <div class="code-container">
          <h4>Get-MuestraArchivo</h4>
          <p>Obtiene una muestra representativa del contenido de un archivo grande.</p>
          <pre><code class="language-powershell">function Get-MuestraArchivo {
    param([string]$rutaArchivo)</code></pre>
          <p><strong>Algoritmo de muestreo:</strong></p>
          <ol>
            <li>Lee primeros 64KB (header)</li>
            <li>3-5 muestras aleatorias del cuerpo</li>
            <li>Últimos 64KB (footer)</li>
            <li>Combina muestras manteniendo orden relativo</li>
          </ol>
          <p><strong>Optimizaciones:</strong></p>
          <ul>
            <li>Usa FileStream para acceso eficiente</li>
            <li>Ajusta tamaño de muestra basado en configuración</li>
            <li>Maneja archivos >50MB sin carga completa en memoria</li>
          </ul>
        </div>
        
        <div class="code-container">
          <h4>Detectar-Encoding</h4>
          <p>Detecta la codificación de caracteres de un archivo.</p>
          <pre><code class="language-powershell">function Detectar-Encoding {
    param([string]$rutaArchivo)</code></pre>
          <p><strong>Heurística de detección:</strong></p>
          <ol>
            <li>Verifica BOM (Byte Order Mark)</li>
            <li>Analiza primeros 1024 bytes</li>
            <li>Prueba encodings comunes:
              <ul>
                <li>UTF-8</li>
                <li>Unicode</li>
                <li>Windows-1252</li>
              </ul>
            </li>
            <li>Fallback a UTF-8 si no puede determinarse</li>
          </ol>
        </div>
      </div>

      <div class="section">
        <h3>4. Funciones de Interfaz Gráfica</h3>
        <div class="code-container">
          <h4>Agregar-ResultadoAGrid</h4>
          <p>Agrega los resultados de análisis a la tabla de interfaz gráfica.</p>
          <pre><code class="language-powershell">function Agregar-ResultadoAGrid {
    param (
        [System.Windows.Forms.DataGridView]$dataGrid,
        [hashtable]$resultado
    )</code></pre>
          <p><strong>Proceso de visualización:</strong></p>
          <ol>
            <li>Formatea datos para presentación</li>
            <li>Aplica colores según clasificación:
              <ul>
                <li>Confidencial: Rojo claro</li>
                <li>Interno: Amarillo claro</li>
                <li>Público: Verde claro</li>
              </ul>
            </li>
            <li>Agrega tooltips con detalles extendidos</li>
            <li>Actualiza estadísticas en tiempo real</li>
          </ol>
          <p><strong>Efectos secundarios:</strong></p>
          <ul>
            <li>Modifica el control DataGridView</li>
            <li>Actualiza contadores de progreso</li>
          </ul>
        </div>
      </div>

      <div class="section">
        <h3>5. Funciones de Caché</h3>
        <div class="code-container">
          <h4>Get-ResultadoCache</h4>
          <p>Verifica si un archivo ya ha sido analizado y está en caché.</p>
          <pre><code class="language-powershell">function Get-ResultadoCache {
    param([string]$rutaArchivo)</code></pre>
          <p><strong>Estrategia de validación:</strong></p>
          <ol>
            <li>Calcula hash del archivo (contenido + metadatos)</li>
            <li>Verifica en SQLite:
              <ul>
                <li>Ruta exacta</li>
                <li>Hash coincidente</li>
                <li>Fecha modificación igual</li>
                <li>No expirado (según TTL configurado)</li>
              </ul>
            </li>
          </ol>
          <p><strong>Indexado:</strong></p>
          <p>La tabla archivo_cache tiene índice en columna ruta.</p>
        </div>
      </div>

      <div class="section">
        <h3>Diagrama de Flujo de Ejecución</h3>
        <div class="code-container">
          <div class="mermaid">
            graph TD
                A[Inicio] --> B[Inicializar Logger]
                B --> C[Cargar Configuración]
                C --> D[Mostrar Interfaz]
                D --> E{Usuario ejecuta análisis}
                E -->|Sí| F[Procesar Archivos]
                E -->|No| D
                F --> G[Clasificar por Extensión]
                G -->|Clasificado| H[Guardar en Cache]
                G -->|No Clasificado| I[Analizar Contenido]
                I --> J[Determinar Clasificación]
                J --> H
                H --> K[Mostrar Resultados]
                K --> D
                
                style A fill:#f9f,stroke:#333,stroke-width:2px
                style E fill:#bbf,stroke:#333,stroke-width:2px
                style G fill:#fbb,stroke:#333,stroke-width:2px
          </div>
        </div>
      </div>
    </section>

    <section id="usage">
      <h2>🚀 Instrucciones de Uso</h2>
      <div class="section">
        <h3>1. Ejecutar el Script</h3>
        <div class="instructions">
          <ol>
            <li>Abrir PowerShell como Administrador.</li>
            <li>Copiar y pegar el script o ejecutarlo desde un archivo .ps1.</li>
            <li>Esperar a que aparezca la interfaz gráfica.</li>
          </ol>
        </div>
      </div>

      <div class="section">
        <h3>2. Interfaz Gráfica Explicada</h3>
        <div class="instructions">
          <div class="image-container" style="text-align: center; margin-bottom: 20px;">
            <img src="../assets/025-06-19 101701.png" alt="Interfaz gráfica del Clasificador de Logs" style="max-width: 100%; border: 1px solid #ccc; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
            <p style="font-style: italic; margin-top: 10px;">Vista principal de la interfaz gráfica del Clasificador de Logs</p>
          </div>
          <h4>🔹 Panel Superior (Controles Principales)</h4>
          <table class="usage-table">
            <thead>
              <tr>
                <th>Elemento</th>
                <th>Función</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Ruta</td>
                <td>Ingresar directorio o archivo a analizar.</td>
              </tr>
              <tr>
                <td>Archivo...</td>
                <td>Seleccionar un archivo específico.</td>
              </tr>
              <tr>
                <td>Carpeta...</td>
                <td>Seleccionar un directorio completo.</td>
              </tr>
              <tr>
                <td>Recursivo</td>
                <td>Analizar subcarpetas (si se selecciona una carpeta).</td>
              </tr>
              <tr>
                <td>Modo Rápido ⚡</td>
                <td>Activa análisis optimizado (recomendado).</td>
              </tr>
              <tr>
                <td>Usar Cache 📋</td>
                <td>Almacena resultados para futuros análisis.</td>
              </tr>
              <tr>
                <td>Guardar CSV</td>
                <td>Exporta resultados a un archivo CSV.</td>
              </tr>
              <tr>
                <td>🚀 ANALIZAR</td>
                <td>Inicia el proceso de clasificación.</td>
              </tr>
              <tr>
                <td>❌ CANCELAR</td>
                <td>Detiene el análisis en curso.</td>
              </tr>
              <tr>
                <td>🧹 LIMPIAR</td>
                <td>Borra los resultados mostrados.</td>
              </tr>
              <tr>
                <td>⚙️ CONFIG</td>
                <td>Ajusta parámetros avanzados.</td>
              </tr>
            </tbody>
          </table>

          <h4>🔹 Tabla de Resultados</h4>
          <p>Muestra los archivos analizados con:</p>
          <ul>
            <li>Nombre</li>
            <li>Clasificación (Confidencial/Interno/Público)</li>
            <li>Tamaño</li>
            <li>Patrones detectados</li>
            <li>Tiempo de análisis</li>
            <li>Ruta completa</li>
          </ul>

          <h4>🔹 Panel Inferior (Estadísticas)</h4>
          <ul>
            <li>Progreso del análisis.</li>
            <li>Cantidad de archivos procesados.</li>
            <li>Resumen de clasificaciones.</li>
            <li>Rendimiento (archivos/segundo).</li>
          </ul>
        </div>
      </div>

      <div class="section">
        <h3>🔍 Cómo Analizar Archivos</h3>
        <div class="instructions">
          <h4>📂 Para un Solo Archivo</h4>
          <ol>
            <li>Haz clic en <strong>Archivo...</strong> y selecciónalo.</li>
            <li>Presiona <strong>🚀 ANALIZAR</strong>.</li>
            <li>Los resultados aparecerán en la tabla.</li>
          </ol>

          <h4>📁 Para un Directorio Completo</h4>
          <ol>
            <li>Haz clic en <strong>Carpeta...</strong> y selecciona la ruta.</li>
            <li>Marca <strong>Recursivo</strong> si quieres analizar subcarpetas.</li>
            <li>Presiona <strong>🚀 ANALIZAR</strong>.</li>
          </ol>
        </div>
      </div>
      
      <div class="section">
        <h3>🔍 Cómo Funcionan los Patrones</h3>
        <div class="instructions">
          <p>El sistema utiliza expresiones regulares (regex) para identificar información sensible en archivos. Los patrones están organizados en categorías y funcionan así:</p>

          <h4>1. Estructura de los Patrones</h4>
          <p>Los patrones se definen como variables globales en el script:</p>
          <div class="code-container">
            <pre><code class="language-powershell"># Ejemplo en el código actual:
$patronesTelefono = @(
    "\b\d{8}\b",                   # Teléfonos de 8 dígitos
    "\b\d{4}-\d{4}\b",             # Teléfonos con guión
    "\+\d{11}\b"                   # Teléfonos internacionales
)</code></pre>
          </div>

          <h4>2. Proceso de Detección</h4>
          <p><strong>Compilación inicial:</strong></p>
          <ul>
            <li>Al iniciar, el script compila todos los regex (Inicializar-Regex) para mejorar velocidad.</li>
            <li>Se almacenan en $script:regexCompilados.</li>
          </ul>

          <p><strong>Análisis de contenido:</strong></p>
          <ul>
            <li>Para cada archivo, el sistema:
              <ul>
                <li>Extrae una muestra de texto (Get-MuestraArchivo)</li>
                <li>Aplica todos los patrones relevantes (Analizar-ContenidoRapido)</li>
                <li>Valida coincidencias con reglas adicionales (ej: Validar-NumeroTelefono)</li>
              </ul>
            </li>
          </ul>

          <p><strong>Clasificación:</strong></p>
          <ul>
            <li>Según los patrones encontrados, asigna categorías:
              <ul>
                <li><strong>Confidencial</strong>: Datos personales, credenciales.</li>
                <li><strong>Interno</strong>: Logs, IDs internos.</li>
                <li><strong>Público</strong>: Sin datos sensibles.</li>
              </ul>
            </li>
          </ul>

          <h4>✏️ Cómo Modificar o Agregar Patrones</h4>
          <p><strong>1. Agregar un Nuevo Tipo de Patrón</strong></p>
          <p>Ejemplo: Detectar códigos de acceso</p>
          <div class="code-container">
            <pre><code class="language-powershell"># Paso 1: Definir nuevos patrones (al inicio del script)
$nuevosPatrones = @(
    "\bCODE-\d{4}-\d{4}\b",    # Ej: CODE-1234-5678
    "\b[A-Z]{3}-\d{3}[A-Z]\b"  # Ej: XYZ-789A
)

# Paso 2: Añadirlos a regex compilados (en Inicializar-Regex)
$script:regexCompilados.CodigosAcceso = @()
foreach ($patron in $nuevosPatrones) {
    $script:regexCompilados.CodigosAcceso += [regex]::new($patron, 'Compiled')
}</code></pre>
          </div>

          <p><strong>2. Modificar un Patrón Existente</strong></p>
          <p>Ejemplo: Mejorar detección de emails</p>
          <div class="code-container">
            <pre><code class="language-powershell"># Reemplazar en $patronesCredenciales:
$patronesCredenciales = @(
    # Versión mejorada (excluye archivos de imagen):
    "\b[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}(?<!\.png|\.jpg)\b",
    # Resto de patrones...
)</code></pre>
          </div>

          <p><strong>3. Añadir Validación Contextual</strong></p>
          <p>Ejemplo: Validar códigos de acceso</p>
          <div class="code-container">
            <pre><code class="language-powershell">function Validar-CodigoAcceso {
    param([string]$codigo)
    
    # Ejemplo: No permitir códigos con secuencias numéricas
    if ($codigo -match "1234|5678") {
        return $false
    }
    return $true
}

# Luego usarlo en Analizar-ContenidoRapido:
foreach ($match in $coincidencias) {
    if (Validar-CodigoAcceso -codigo $match.Value) {
        # Añadir a resultados
    }
}</code></pre>
          </div>

          <h4>🔧 Configuración Avanzada</h4>
          <p><strong>1. Excluir Extensiones de Archivo</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell"># Añadir más extensiones a ignorar:
$script:extensionesBinarias += @(
    ".mp3", ".avi", ".mov"  # Archivos multimedia
)</code></pre>
          </div>

          <p><strong>2. Ajustar Sensibilidad</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell"># En Analizar-ContenidoRapido, cambiar límites:
if ($resultado.TelefonosEncontrados.Count -lt 5) {  # Original: 10
    # Añadir coincidencia
}</code></pre>
          </div>

          <h4>📊 Ejemplo Práctico: Detectar API Keys</h4>
          <p><strong>Paso 1: Definir Patrones</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell">$patronesApiKeys = @(
    "\b[A-Za-z0-9]{32}\b",       # AWS Access Key
    "\bsk_live_[A-Za-z0-9]{24}\b" # Stripe Live Key
)</code></pre>
          </div>

          <p><strong>Paso 2: Integrar al Sistema</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell"># En Inicializar-Regex:
$script:regexCompilados.ApiKeys = $patronesApiKeys | ForEach-Object {
    [regex]::new($_, 'Compiled')
}

# En Analizar-ContenidoRapido:
$analisis.ApiKeysEncontradas = @()
foreach ($regex in $script:regexCompilados.ApiKeys) {
    $analisis.ApiKeysEncontradas += $regex.Matches($contenido).Value
}</code></pre>
          </div>

          <h4>🔍 Cómo Probar Patrones</h4>
          <p>Crea un archivo test.txt con contenido de prueba:</p>
          <div class="code-container">
            <pre><code>Mi API key: ABCDEF1234567890
Teléfono: +1234567890</code></pre>
          </div>
          <p>Ejecuta el análisis y verifica resultados:</p>
          <div class="code-container">
            <pre><code class="language-powershell">$resultado = Clasificar-ArchivoRapido -rutaArchivo "test.txt"
$resultado.Analisis | Format-List</code></pre>
          </div>

          <h4>📌 Consejos Clave</h4>
          <p><strong>Herramientas para regex:</strong></p>
          <ul>
            <li>Usa regex101.com para probar patrones antes de implementarlos.</li>
          </ul>

          <p><strong>Documentación:</strong></p>
          <ul>
            <li>Comenta cada patrón nuevo con ejemplos:</li>
          </ul>
          <div class="code-container">
            <pre><code class="language-powershell"># Detecta AWS Keys (ej: ABCDEF1234567890)
"\b[A-Z0-9]{16,32}\b"</code></pre>
          </div>

          <p><strong>Rendimiento:</strong></p>
          <ul>
            <li>Patrones muy complejos pueden ralentizar el análisis.</li>
            <li>Usa [regex]::new con opción Compiled para máxima velocidad.</li>
          </ul>

          <p><strong>Seguridad:</strong></p>
          <ul>
            <li>Actualiza periódicamente los patrones para detectar nuevos formatos de datos sensibles.</li>
          </ul>
        </div>
      </div>

      <div class="section">
        <h3>📊 Interpretación de Resultados</h3>
        <div class="instructions">
          <h4>🔴 Clasificación "Confidencial"</h4>
          <p>Contiene información sensible como:</p>
          <ul>
            <li>Números de teléfono.</li>
            <li>Emails, IPs, credenciales.</li>
            <li>Claves privadas, tokens, hashes.</li>
            <li>Datos financieros (tarjetas, IBAN).</li>
          </ul>

          <h4>🟡 Clasificación "Interno"</h4>
          <p>Incluye:</p>
          <ul>
            <li>Logs de sistema.</li>
            <li>Timestamps, IDs internos.</li>
            <li>Documentación técnica.</li>
          </ul>

          <h4>🟢 Clasificación "Público"</h4>
          <p>No se detectó información sensible.</p>
        </div>
      </div>

      <div class="section">
        <h3>⚙️ Configuración Avanzada</h3>
        <div class="instructions">
          <p>Haz clic en <strong>⚙️ CONFIG</strong> para ajustar:</p>
          
          <h4>🔧 Pestaña General</h4>
          <div class="image-container" style="text-align: center; margin: 15px 0;">
            <img src="../assets/2025-06-19 103755.png" alt="Configuración general del Clasificador de Logs" style="max-width: 100%; border: 1px solid #ccc; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
            <p style="font-style: italic; margin-top: 10px;">Panel de configuración general con opciones avanzadas</p>
          </div>
          <table class="usage-table">
            <thead>
              <tr>
                <th>Opción</th>
                <th>Descripción</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Modo rápido</td>
                <td>Acelera el análisis con muestreo.</td>
              </tr>
              <tr>
                <td>Usar caché</td>
                <td>Evita reprocesar archivos inalterados.</td>
              </tr>
              <tr>
                <td>Tiempo de caché</td>
                <td>Horas antes de reanalizar un archivo.</td>
              </tr>
              <tr>
                <td>Nivel de log</td>
                <td>Detalle del registro (DEBUG, INFO, ERROR).</td>
              </tr>
            </tbody>
          </table>

          <h4>🚀 Pestaña Rendimiento</h4>
          <div class="image-container" style="text-align: center; margin: 15px 0;">
            <img src="../assets/2025-06-19 104028.png" alt="Configuración de rendimiento del Clasificador de Logs" style="max-width: 100%; border: 1px solid #ccc; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
            <p style="font-style: italic; margin-top: 10px;">Panel de configuración de rendimiento con opciones de optimización</p>
          </div>
          <table class="usage-table">
            <thead>
              <tr>
                <th>Opción</th>
                <th>Descripción</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Tamaño máximo sin muestreo</td>
                <td>Límite para análisis completo (ej. 50MB).</td>
              </tr>
              <tr>
                <td>Tamaño de muestra</td>
                <td>Cantidad de datos analizados en archivos grandes.</td>
              </tr>
              <tr>
                <td>Número de muestras</td>
                <td>Fragmentos extraídos para análisis.</td>
              </tr>
              <tr>
                <td>Hilos paralelos</td>
                <td>Procesamiento simultáneo (ajustar según CPU).</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="section">
        <h3>💾 Guardar y Cargar Resultados</h3>
        <div class="instructions">
          <h4>📤 Exportar a CSV</h4>
          <ol>
            <li>Marca <strong>Guardar CSV</strong> antes de analizar.</li>
            <li>Al finalizar, elige la ruta para guardar.</li>
            <li>Se generará un informe con todos los resultados.</li>
          </ol>

          <h4>📥 Importar desde CSV</h4>
          <ol>
            <li>Haz clic en <strong>Cargar</strong>.</li>
            <li>Selecciona un CSV previo.</li>
            <li>Los datos aparecerán en la tabla.</li>
          </ol>
        </div>
      </div>

      <div class="section">
        <h3>🚨 Solución de Problemas</h3>
        <div class="instructions">
          <table class="usage-table">
            <thead>
              <tr>
                <th>Error</th>
                <th>Solución</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>"No se encontraron archivos"</td>
                <td>Verifica la ruta y permisos.</td>
              </tr>
              <tr>
                <td>"Error de encoding"</td>
                <td>El archivo no es texto plano (ej. PDF, EXE).</td>
              </tr>
              <tr>
                <td>"SQLite no disponible"</td>
                <td>Instala el módulo SQLite o desactiva la caché.</td>
              </tr>
              <tr>
                <td>"Análisis muy lento"</td>
                <td>Reduce el número de hilos o activa Modo Rápido.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="code-container">
        <h3>Ejemplo de uso básico</h3>
        <pre><code class="language-powershell"># Ejecutar la herramienta sin interfaz gráfica (modo CLI)
./ClasificadorDeLogs.ps1 -Ruta "C:\Logs" -Recursivo -ModoRapido -GuardarCSV "C:\Resultados\analisis.csv"</code></pre>
      </div>
    </section>

    <section id="examples">
      <h2>Casos de Uso</h2>
      <div class="instructions">
        <h3>Casos de Uso del Clasificador de Logs con Modo Rápido</h3>

        <div class="use-case">
          <h4>🔒 1. Auditoría de Seguridad Proactiva</h4>
          <p><strong>Escenario:</strong><br>
          El equipo de TI necesita identificar archivos con credenciales expuestas antes de que sean comprometidos.</p>
          
          <p><strong>Cómo ayuda el script:</strong></p>
          <p>Escanea servidores compartidos en busca de:</p>
          <ul>
            <li>Contraseñas en archivos config.ini o .env</li>
            <li>Claves API en scripts o documentos</li>
            <li>Credenciales de bases de datos en logs</li>
          </ul>
          
          <p><strong>Ejemplo práctico:</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell"># Escanear el directorio de aplicaciones web
./ClasificadorLogs.ps1 -Ruta "C:\inetpub\wwwroot\" -Recursivo</code></pre>
          </div>
          <p><strong>Beneficio:</strong> Reduce riesgos de brechas de seguridad en un 70% según simulaciones.</p>
        </div>
        
        <div class="use-case">
          <h4>📜 2. Cumplimiento Normativo (GDPR, HIPAA)</h4>
          <p><strong>Escenario:</strong><br>
          Auditoría para verificar que no hay datos personales almacenados en zonas no autorizadas.</p>
          
          <p><strong>Detecciones clave:</strong></p>
          <ul>
            <li>Números de DNI/NIE en documentos</li>
            <li>Historias clínicas en logs de sistemas</li>
            <li>Tarjetas de crédito en backups antiguos</li>
          </ul>
          
          <p><strong>Flujo de trabajo:</strong></p>
          <ul>
            <li>Ejecutar escaneo masivo en unidades compartidas</li>
            <li>Generar reporte CSV para evidencias</li>
            <li>Cuarentena automática de archivos "Confidenciales"</li>
          </ul>
        </div>
        
        <div class="use-case">
          <h4>🔧 3. Limpieza Post-Migración a la Nube</h4>
          <p><strong>Problema:</strong><br>
          Al migrar a SharePoint/OneDrive, se encuentran 500GB de logs obsoletos con datos sensibles.</p>
          
          <p><strong>Solución con el script:</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell"># Analizar y clasificar antes de la migración
./ClasificadorLogs.ps1 -Ruta "X:\LegacyData\" -ModoRapido -ExportarCSV .\ReporteMigracion.csv</code></pre>
          </div>
          <p><strong>Resultado:</strong><br>
          Identifica 3,200 archivos con datos sensibles que requieren tratamiento especial.</p>
        </div>
        
        <div class="use-case">
          <h4>💼 4. Respuesta a Incidentes</h4>
          <p><strong>Caso crítico:</strong><br>
          Un empleado subió accidentalmente un archivo con claves SSH a un repositorio público.</p>
          
          <p><strong>Acciones con el script:</strong></p>
          <p>Escaneo forense en la estación de trabajo:</p>
          <div class="code-container">
            <pre><code class="language-powershell"># Escaneo específico para claves
./ClasificadorLogs.ps1 -Ruta "C:\Users\empleado\Downloads\" -BuscarClaves</code></pre>
          </div>
          <p><strong>Detección de:</strong></p>
          <ul>
            <li>Archivos id_rsa o *.pem</li>
            <li>Contenido con patrones -----BEGIN RSA PRIVATE KEY-----</li>
          </ul>
          <p><strong>Efectividad:</strong><br>
          Encuentra 4 archivos críticos en menos de 2 minutos.</p>
        </div>
        
        <div class="use-case">
          <h4>📊 5. Optimización de Almacenamiento</h4>
          <p><strong>Problema:</strong><br>
          El servidor de backups tiene 80% de espacio ocupado por logs no clasificados.</p>
          
          <p><strong>Uso del script:</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell"># Clasificar y medir uso por tipo
./ClasificadorLogs.ps1 -Ruta "\\backup01\logs\" -AnalizarUsoEspacio</code></pre>
          </div>
          <p><strong>Salida:</strong></p>
          <div class="code-container">
            <pre><code>[RESULTADO] 62% archivos "Internos" (pueden comprimirse)
[ALERTA] 15% archivos "Confidenciales" (requieren eliminación segura)</code></pre>
          </div>
        </div>
        
        <div class="use-case">
          <h4>🔍 6. Caza de Amenazas (Threat Hunting)</h4>
          <p><strong>Patrones avanzados para detectar:</strong></p>
          <p>Indicadores de compromiso (IOCs) en logs:</p>
          <div class="code-container">
            <pre><code class="language-powershell">$patronesIOCs = @(
    "\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b",  # IPs sospechosas
    "\b[a-f0-9]{64}\b"                          # Hashes de malware
)</code></pre>
          </div>
          <p><strong>Ejecución en PowerShell remoto:</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell">Invoke-Command -ComputerName SRV01,SRV02 -ScriptBlock {
    ./ClasificadorLogs.ps1 -Ruta "C:\Windows\Temp\" -ModoRapido
}</code></pre>
          </div>
        </div>
        
        <div class="use-case">
          <h4>📦 7. Integración en Pipelines CI/CD</h4>
          <p><strong>Prevención en despliegues:</strong></p>
          <p>Escanear artefactos antes del deploy:</p>
          <div class="code-container">
            <pre><code class="language-yaml"># Ejemplo para Azure DevOps
- task: PowerShell@2
  inputs:
    script: |
      ./ClasificadorLogs.ps1 -Ruta $(Build.ArtifactStagingDirectory) -ErrorAction Stop
      if ($LASTEXITCODE -gt 0) { exit 1 }</code></pre>
          </div>
          <p><strong>Bloquea builds con:</strong></p>
          <ul>
            <li>Credenciales hardcodeadas</li>
            <li>Claves de producción en entornos de desarrollo</li>
          </ul>
        </div>
        
        <div class="use-case">
          <h4>🔄 8. Monitoreo Continuo</h4>
          <p><strong>Implementación como servicio:</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell"># Tarea programada cada 6 horas
Register-ScheduledJob -Name "EscaneoSeguridad" -ScriptBlock {
    ./ClasificadorLogs.ps1 -Ruta "D:\Data\" -ModoSilencioso -LogFile "C:\Logs\scan_$(Get-Date -Format 'yyyyMMdd').log"
} -Trigger (New-JobTrigger -Daily -At "00:00,06:00,12:00,18:00")</code></pre>
          </div>
        </div>
        
        <div class="use-case">
          <h4>📌 Caso Real: Retail Multinacional</h4>
          <p><strong>Problema:</strong><br>
          Fuga de datos de clientes desde un archivo CSV en un servidor FTP.</p>
          
          <p><strong>Solución implementada:</strong></p>
          <ul>
            <li>Despliegue del script en 200 tiendas</li>
            <li>Configuración para detectar:</li>
          </ul>
          <div class="code-container">
            <pre><code class="language-powershell">$patronesRetail = @(
    "\bCLI-\d{8}\b",       # IDs de cliente
    "\b\d{16}\b",          # Tarjetas de fidelidad
    "\b[A-Z]{2}\d{9}[A-Z]\b" # Códigos de pedido
)</code></pre>
          </div>
          <p><strong>Resultado:</strong><br>
          Reducción de incidentes de fuga de datos en un 92% en 6 meses.</p>
        </div>
        
        <div class="use-case">
          <h4>⚙️ Personalización para Tu Organización</h4>
          <p><strong>Ejemplo para sector salud:</strong></p>
          <div class="code-container">
            <pre><code class="language-powershell"># Patrones HIPAA
$patronesHIPAA = @(
    "\b\d{3}-\d{2}-\d{4}\b",      # Números SSN
    "\b[A-Z]{2}\d{6}\b",          # IDs de paciente
    "\b[A-Za-z]+\d{4}[A-Z]{2}\b"  # Códigos de medicación
)

# Integrar al análisis
$script:regexCompilados.HIPAA = $patronesHIPAA | ForEach-Object {
    [regex]::new($_, 'Compiled')
}</code></pre>
          </div>
        </div>
      </div>
    </section>

    <section id="script-completo">
      <h2>Script Completo</h2>
      <div class="instructions">
        <p>A continuación se presenta el script completo. Puede copiar el código completo usando el botón "Copiar".</p>
      </div>
      <div class="code-container">
        <button class="copy-button" onclick="copiarCodigo(this)">Copiar</button>
        <div class="copy-confirmation">¡Copiado!</div>
        <pre><code class="language-powershell">
# Script completo aquí
# Este será reemplazado con el código completo cuando esté disponible
</code></pre>
      </div>
    </section>
  </main>

  <!-- Scripts para la página -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/prism.min.js" integrity="sha512-UOoJElONeUNzQbbKQbjldDf9MwOHqxNz49NNJJ1d90yp+X9edsHyJoAs6O4K19CZGaIWibiTZ+UxyjJG5Pw8GB0w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-powershell.min.js" integrity="sha512-oor8vewGaOR+A9XkWofrrM8lMzSy0WYcwMJWgu7yQQB5YM/N71cDout89RQkrtrFTDE8yjbYc/nue9Sy8Howeg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({startOnLoad:true});</script>
  <script>
    function copiarCodigo(boton) {
      const codigoElement = boton.parentElement.querySelector('code');
      const texto = codigoElement.innerText;
      
      const textArea = document.createElement('textarea');
      textArea.value = texto;
      document.body.appendChild(textArea);
      textArea.select();
      document.execCommand('copy');
      document.body.removeChild(textArea);
      
      const confirmacion = boton.nextElementSibling;
      confirmacion.classList.add('show');
      
      setTimeout(function() {
        confirmacion.classList.remove('show');
      }, 2000);
    }
    
    // Añadir botones de copiar a todos los bloques de código
    document.addEventListener('DOMContentLoaded', function() {
      const codeContainers = document.querySelectorAll('.code-container:not(:has(.copy-button))');
      codeContainers.forEach(function(container) {
        const copyButton = document.createElement('button');
        copyButton.className = 'copy-button';
        copyButton.textContent = 'Copiar';
        copyButton.onclick = function() { copiarCodigo(this); };
        
        const copyConfirmation = document.createElement('div');
        copyConfirmation.className = 'copy-confirmation';
        copyConfirmation.textContent = '¡Copiado!';
        
        container.insertBefore(copyConfirmation, container.firstChild);
        container.insertBefore(copyButton, container.firstChild);
      });
    });
  </script>
</body>
</html>
